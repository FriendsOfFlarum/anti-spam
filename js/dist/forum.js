(()=>{var t={n:e=>{var s=e&&e.__esModule?()=>e.default:()=>e;return t.d(s,{a:s}),s},d:(e,s)=>{for(var r in s)t.o(s,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:s[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};(()=>{"use strict";t.r(e),t.d(e,{extend:()=>M});const s=flarum.reg.get("core","forum/app");var r=t.n(s);const a=flarum.reg.get("core","common/extend"),o=flarum.reg.get("core","common/components/Button");var n=t.n(o);const i=flarum.reg.get("core","forum/utils/UserControls");var l=t.n(i);function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function d(t,e,s){return(e=function(t){var e=function(t){if("object"!=u(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var s=e.call(t,"string");if("object"!=u(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==u(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const c=flarum.reg.get("core","common/components/Form");var p=t.n(c);const f=flarum.reg.get("core","common/components/Modal");var h=t.n(f);const b=flarum.reg.get("core","common/components/Switch");var g=t.n(b);class _ extends(h()){constructor(){super(...arguments),d(this,"user",void 0),d(this,"hardDeleteUser",void 0),d(this,"hardDeleteDiscussions",void 0),d(this,"hardDeletePosts",void 0),d(this,"moveDiscussionsToQuarantine",void 0),d(this,"reportToSfs",void 0)}oninit(t){super.oninit(t),this.user=this.attrs.user;const e=r().forum.attribute("fof-anti-spam")["default-options"];this.hardDeleteUser=e.deleteUser,this.hardDeleteDiscussions=e.deleteDiscussions,this.hardDeletePosts=e.deletePosts,this.moveDiscussionsToQuarantine=e.spamQuarantine,this.reportToSfs=e.reportToSfs}className(){return"HandleSpammerModal Modal--medium"}title(){return r().translator.trans("fof-anti-spam.forum.spammer_modal.title",{username:this.user.displayName()})}content(){var t;const e=r().initializers.has("flarum-tags"),s=!(null==(t=r().forum.attribute("fof-anti-spam").stopforumspam)||!t.enabled);return m("div",{className:"Modal-body"},m(p(),null,m("p",{className:"helpText"},r().translator.trans("fof-anti-spam.forum.spammer_modal.intro")),m("div",{className:"Form-group"},m(g(),{state:this.hardDeleteDiscussions,onchange:t=>{this.hardDeleteDiscussions=t,m.redraw()}},r().translator.trans("fof-anti-spam.forum.spammer_modal.hard_delete_discussions_label")),m("p",{className:"helpText"},r().translator.trans("fof-anti-spam.forum.spammer_modal.hard_delete_discussions_help"))),m("div",{className:"Form-group"},m(g(),{state:this.hardDeletePosts,onchange:t=>{this.hardDeletePosts=t}},r().translator.trans("fof-anti-spam.forum.spammer_modal.hard_delete_posts_label")),m("p",{className:"helpText"},r().translator.trans("fof-anti-spam.forum.spammer_modal.hard_delete_posts_help"))),e&&!this.hardDeleteDiscussions&&m("div",{className:"Form-group"},m(g(),{state:this.moveDiscussionsToQuarantine,onchange:t=>{this.moveDiscussionsToQuarantine=t}},r().translator.trans("fof-anti-spam.forum.spammer_modal.move_discussions_tag_label")),m("p",{className:"helpText"},r().translator.trans("fof-anti-spam.forum.spammer_modal.move_discussions_tag_help"))),m("div",{className:"Form-group"},m(g(),{state:this.hardDeleteUser,onchange:t=>{this.hardDeleteUser=t}},r().translator.trans("fof-anti-spam.forum.spammer_modal.hard_delete_user_label")),m("p",{className:"helpText"},r().translator.trans("fof-anti-spam.forum.spammer_modal.hard_delete_user_help"))),s&&m("div",{className:"Form-group"},m(g(),{state:this.reportToSfs,onchange:t=>{this.reportToSfs=t}},r().translator.trans("fof-anti-spam.forum.spammer_modal.report_to_sfs_label")),m("p",{className:"helpText"},r().translator.trans("fof-anti-spam.forum.spammer_modal.report_to_sfs_help"))),m("div",{className:"Form-group"},m(n(),{className:"Button Button--primary",onclick:()=>this.submitData(),loading:this.loading,disabled:this.loading},r().translator.trans("fof-anti-spam.forum.spammer_modal.process_button")))))}submitData(){this.loading=!0;const t={options:{deletePosts:this.hardDeletePosts,deleteDiscussions:this.hardDeleteDiscussions,deleteUser:this.hardDeleteUser,moveDiscussionsToQuarantine:this.moveDiscussionsToQuarantine,reportToSfs:this.reportToSfs}};r().request({method:"POST",url:"".concat(r().forum.attribute("apiUrl"),"/users/").concat(this.user.id(),"/spamblock"),body:t}).then(()=>{this.loading=!1,this.hide()})}}function v(){(0,a.extend)(l(),"moderationControls",function(t,e){e.canSpamblock()&&t.add("spammer",m(n(),{icon:"fas fa-pastafarianism",onclick:()=>{r().modal.show(_,{user:e})}},r().translator.trans("fof-anti-spam.forum.user_controls.spammer_button")))})}flarum.reg.add("fof-anti-spam","forum/components/HandleSpammerModal",_),flarum.reg.add("fof-anti-spam","forum/extenders/addSpamblockControls",v);const D=flarum.reg.get("core","common/extenders");var y=t.n(D);const S=flarum.reg.get("core","common/models/User");var T=t.n(S);const N=flarum.reg.get("core","common/Model");var P=t.n(N);class x extends(P()){ip(){return P().attribute("ip").call(this)}email(){return P().attribute("email").call(this)}username(){return P().attribute("username").call(this)}sfsData(){return P().attribute("sfsData").call(this)}provider(){return P().attribute("provider").call(this)}providerData(){return P().attribute("providerData").call(this)}attemptedAt(){return P().attribute("attemptedAt",P().transformDate).call(this)}}flarum.reg.add("fof-anti-spam","common/models/BlockedRegistration",x);const M=[(new(y().Store)).add("blocked-registrations",x),new(y().Model)(T()).attribute("canSpamblock")];r().initializers.add("fof-anti-spam",()=>{v()})})(),module.exports=e})();
//# sourceMappingURL=forum.js.map