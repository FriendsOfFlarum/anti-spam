/*! For license information please see admin.js.LICENSE.txt */
(()=>{var t={648:(t,e,n)=>{var a=n(288).default;function r(){"use strict";t.exports=r=function(){return n},t.exports.__esModule=!0,t.exports.default=t.exports;var e,n={},o=Object.prototype,s=o.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},l="function"==typeof Symbol?Symbol:{},c=l.iterator||"@@iterator",m=l.asyncIterator||"@@asyncIterator",u=l.toStringTag||"@@toStringTag";function p(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{p({},"")}catch(e){p=function(t,e,n){return t[e]=n}}function f(t,e,n,a){var r=e&&e.prototype instanceof _?e:_,o=Object.create(r.prototype),s=new T(a||[]);return i(o,"_invoke",{value:L(t,n,s)}),o}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}n.wrap=f;var g="suspendedStart",h="suspendedYield",v="executing",b="completed",y={};function _(){}function k(){}function w(){}var x={};p(x,c,(function(){return this}));var N=Object.getPrototypeOf,R=N&&N(N(C([])));R&&R!==o&&s.call(R,c)&&(x=R);var P=w.prototype=_.prototype=Object.create(x);function S(t){["next","throw","return"].forEach((function(e){p(t,e,(function(t){return this._invoke(e,t)}))}))}function B(t,e){function n(r,o,i,l){var c=d(t[r],t,o);if("throw"!==c.type){var m=c.arg,u=m.value;return u&&"object"==a(u)&&s.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,i,l)}),(function(t){n("throw",t,i,l)})):e.resolve(u).then((function(t){m.value=t,i(m)}),(function(t){return n("throw",t,i,l)}))}l(c.arg)}var r;i(this,"_invoke",{value:function(t,a){function o(){return new e((function(e,r){n(t,a,e,r)}))}return r=r?r.then(o,o):o()}})}function L(t,n,a){var r=g;return function(o,s){if(r===v)throw new Error("Generator is already running");if(r===b){if("throw"===o)throw s;return{value:e,done:!0}}for(a.method=o,a.arg=s;;){var i=a.delegate;if(i){var l=E(i,a);if(l){if(l===y)continue;return l}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(r===g)throw r=b,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);r=v;var c=d(t,n,a);if("normal"===c.type){if(r=a.done?b:h,c.arg===y)continue;return{value:c.arg,done:a.done}}"throw"===c.type&&(r=b,a.method="throw",a.arg=c.arg)}}}function E(t,n){var a=n.method,r=t.iterator[a];if(r===e)return n.delegate=null,"throw"===a&&t.iterator.return&&(n.method="return",n.arg=e,E(t,n),"throw"===n.method)||"return"!==a&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+a+"' method")),y;var o=d(r,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,y;var s=o.arg;return s?s.done?(n[t.resultName]=s.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function C(t){if(t||""===t){var n=t[c];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function n(){for(;++r<t.length;)if(s.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(a(t)+" is not iterable")}return k.prototype=w,i(P,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:k,configurable:!0}),k.displayName=p(w,u,"GeneratorFunction"),n.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===k||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,p(t,u,"GeneratorFunction")),t.prototype=Object.create(P),t},n.awrap=function(t){return{__await:t}},S(B.prototype),p(B.prototype,m,(function(){return this})),n.AsyncIterator=B,n.async=function(t,e,a,r,o){void 0===o&&(o=Promise);var s=new B(f(t,e,a,r),o);return n.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(P),p(P,u,"Generator"),p(P,c,(function(){return this})),p(P,"toString",(function(){return"[object Generator]"})),n.keys=function(t){var e=Object(t),n=[];for(var a in e)n.push(a);return n.reverse(),function t(){for(;n.length;){var a=n.pop();if(a in e)return t.value=a,t.done=!1,t}return t.done=!0,t}},n.values=C,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var n in this)"t"===n.charAt(0)&&s.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(a,r){return i.type="throw",i.arg=t,n.next=a,r&&(n.method="next",n.arg=e),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],i=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var l=s.call(o,"catchLoc"),c=s.call(o,"finallyLoc");if(l&&c){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&s.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var o=r?r.completion:{};return o.type=t,o.arg=e,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),j(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var a=n.completion;if("throw"===a.type){var r=a.arg;j(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,a){return this.delegate={iterator:C(t),resultName:n,nextLoc:a},"next"===this.method&&(this.arg=e),y}},n}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports},288:t=>{function e(n){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},357:(t,e,n)=>{var a=n(648)();t.exports=a;try{regeneratorRuntime=a}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=a:Function("r","regeneratorRuntime = r")(a)}}},e={};function n(a){var r=e[a];if(void 0!==r)return r.exports;var o=e[a]={exports:{}};return t[a](o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var a in e)n.o(e,a)&&!n.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var a={};(()=>{"use strict";n.r(a),n.d(a,{extend:()=>L});const t=flarum.core.compat["admin/app"];var e=n.n(t);function r(t,e,n,a,r,o,s){try{var i=t[o](s),l=i.value}catch(t){return void n(t)}i.done?e(l):Promise.resolve(l).then(a,r)}function o(t,e){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},o(t,e)}function s(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,o(t,e)}var i=n(357),l=n.n(i);const c=flarum.core.compat["admin/components/ExtensionPage"];var u=n.n(c);const p=flarum.core.compat["common/components/Button"];var f=n.n(p);const d=flarum.core.compat["common/components/Link"];var g=n.n(d);const h=flarum.core.compat["common/components/LoadingIndicator"];var v=n.n(h);const b=flarum.core.compat["common/utils/ItemList"];var y=n.n(b);const _=flarum.core.compat["common/helpers/fullTime"];var k=n.n(_),w=function(t){function n(){for(var e,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))||this).page=void 0,e.blockedLoading=!1,e.blockedRegistrations=null,e.currentPage=1,e.totalPages=1,e}s(n,t);var a=n.prototype;return a.oninit=function(e){t.prototype.oninit.call(this,e),this.page="settings"},a.content=function(){return m("div",{className:"FoFAntiSpamSettings"},m("div",{className:"container"},this.menuButtons(),"settings"===this.page&&this.settingsContent(),"blocked-registrations"===this.page&&this.blockedRegistrationsContent()))},a.menuButtons=function(){var t=this;return m("div",{className:"MenuButtons"},m(f(),{className:"Button "+("settings"===this.page?"active":""),icon:"fas fa-cog",onclick:function(){return t.setPage("settings")}},e().translator.trans("fof-anti-spam.admin.settings.button")),m(f(),{className:"Button "+("blocked-registrations"===this.page?"active":""),icon:"fas fa-ban",onclick:function(){return t.setPage("blocked-registrations")}},e().translator.trans("fof-anti-spam.admin.blocked_registrations.button")))},a.setPage=function(t){this.page=t,"blocked-registrations"!==t||this.blockedRegistrations?m.redraw():this.loadData()},a.settingsContent=function(){var t=e().initializers.has("flarum-tags");return m("div",{className:"FoFAntiSpamSettings--settings"},m("div",{className:"Form"},m("div",{className:"Section Section--defaultActions"},m("h3",null,e().translator.trans("fof-anti-spam.admin.settings.default-actions.heading")),m("p",{className:"helpText"},e().translator.trans("fof-anti-spam.admin.settings.default-actions.introduction")),this.buildSettingComponent({type:"boolean",setting:"fof-anti-spam.actions.deleteUser",label:e().translator.trans("fof-anti-spam.admin.settings.default-actions.delete_user_label"),help:e().translator.trans("fof-anti-spam.admin.settings.default-actions.delete_user_help")}),this.buildSettingComponent({type:"boolean",setting:"fof-anti-spam.actions.deletePosts",label:e().translator.trans("fof-anti-spam.admin.settings.default-actions.delete_posts_label"),help:e().translator.trans("fof-anti-spam.admin.settings.default-actions.delete_posts_help")}),this.buildSettingComponent({type:"boolean",setting:"fof-anti-spam.actions.deleteDiscussions",label:e().translator.trans("fof-anti-spam.admin.settings.default-actions.delete_discussions_label"),help:e().translator.trans("fof-anti-spam.admin.settings.default-actions.delete_discussions_help")}),t&&this.buildSettingComponent({type:"flarum-tags.select-tags",setting:"fof-anti-spam.actions.moveDiscussionsToTags",label:e().translator.trans("fof-anti-spam.admin.settings.default-actions.move_discussions_to_tags_label"),help:e().translator.trans("fof-anti-spam.admin.settings.default-actions.move_discussions_to_tags_help"),options:{requireParentTag:!0,limits:{max:{primary:1},min:{primary:1}}}})),m("div",{className:"Section Section--stopforumspam"},m("h3",null,e().translator.trans("fof-anti-spam.admin.settings.stopforumspam.heading")),m("div",{className:"Introduction"},m("p",{className:"helpText"},e().translator.trans("fof-anti-spam.admin.settings.stopforumspam.introduction",{a:m(g(),{href:"https://stopforumspam.com",target:"_blank",external:!0})}))),this.buildSettingComponent({type:"select",setting:"fof-anti-spam.regionalEndpoint",options:["closest","europe","us"].reduce((function(t,n){return t[n]=e().translator.trans("fof-anti-spam.admin.settings.stopforumspam.region_"+n+"_label"),t}),{}),label:e().translator.trans("fof-anti-spam.admin.settings.stopforumspam.regional_endpoint_label"),help:e().translator.trans("fof-anti-spam.admin.settings.stopforumspam.regional_endpoint_help"),default:"closest"}),this.buildSettingComponent({type:"boolean",setting:"fof-anti-spam.sfs-lookup",label:e().translator.trans("fof-anti-spam.admin.settings.stopforumspam.sfs_lookup_label"),help:e().translator.trans("fof-anti-spam.admin.settings.stopforumspam.sfs_lookup_help")}),this.buildSettingComponent({type:"boolean",setting:"fof-anti-spam.report_blocked_registrations",label:e().translator.trans("fof-anti-spam.admin.settings.stopforumspam.report_blocked_registrations_label"),help:e().translator.trans("fof-anti-spam.admin.settings.stopforumspam.report_blocked_registrations_help")}),this.buildSettingComponent({type:"boolean",setting:"fof-anti-spam.username",label:e().translator.trans("fof-anti-spam.admin.settings.stopforumspam.username_label")}),this.buildSettingComponent({type:"boolean",setting:"fof-anti-spam.ip",label:e().translator.trans("fof-anti-spam.admin.settings.stopforumspam.ip_label")}),this.buildSettingComponent({type:"boolean",setting:"fof-anti-spam.email",label:e().translator.trans("fof-anti-spam.admin.settings.stopforumspam.email_label")}),this.buildSettingComponent({type:"boolean",setting:"fof-anti-spam.emailhash",label:e().translator.trans("fof-anti-spam.admin.settings.stopforumspam.email_hash_label"),help:e().translator.trans("fof-anti-spam.admin.settings.stopforumspam.email_hash_help")}),this.buildSettingComponent({type:"number",setting:"fof-anti-spam.frequency",label:e().translator.trans("fof-anti-spam.admin.settings.stopforumspam.frequency_label"),help:e().translator.trans("fof-anti-spam.admin.settings.stopforumspam.frequency_help"),placeholder:"5",required:!0}),this.buildSettingComponent({type:"number",setting:"fof-anti-spam.confidence",label:e().translator.trans("fof-anti-spam.admin.settings.stopforumspam.confidence_label"),help:e().translator.trans("fof-anti-spam.admin.settings.stopforumspam.confidence_help"),min:0,max:100,placeholder:"50.0",required:!0}),m("p",{className:"helpText"},e().translator.trans("fof-anti-spam.admin.settings.stopforumspam.api_key_text")),this.buildSettingComponent({type:"string",setting:"fof-anti-spam.api_key",label:e().translator.trans("fof-anti-spam.admin.settings.stopforumspam.api_key_label"),help:e().translator.trans("fof-anti-spam.admin.settings.stopforumspam.api_key_instructions_text",{register:m("a",{href:"https://www.stopforumspam.com/forum/register.php"}),key:m("a",{href:"https://www.stopforumspam.com/keys"})})})),m("hr",null),this.submitButton()))},a.blockedRegistrationsContent=function(){var t=this;return m("div",{className:"FoFAntiSpamSettings--blockedRegistrations"},m("div",{className:"Form"},m("h3",null,e().translator.trans("fof-anti-spam.admin.blocked_registrations.title")),this.blockedLoading&&m(v(),null),!this.blockedLoading&&this.blockedRegistrations&&0===this.blockedRegistrations.length&&m("div",null,m("p",null,e().translator.trans("fof-anti-spam.admin.blocked_registrations.no-records"))),!this.blockedLoading&&this.blockedRegistrations&&this.blockedRegistrations.length>0&&m("div",null,m("p",{className:"helpText"},e().translator.trans("fof-anti-spam.admin.blocked_registrations.help")),m("div",{className:"BlockedRegistrations--list"},this.blockedRegistrations.map((function(e){return m("div",{className:"BlockedRegistrations--item"},m("div",{className:"BlockedRegistrations-item--details"},t.detailItems(e).toArray()),m("div",{className:"BlockedRegistrations-item--actions"},t.actionItems(e).toArray()))}))),this.renderPagination())))},a.loadData=function(){var t,a=(t=l().mark((function t(a){var r,o;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===a&&(a=1),this.blockedLoading=!0,m.redraw(),t.prev=3,t.next=6,e().store.find("blocked-registrations",{page:{offset:(a-1)*n.ITEMS_PER_PAGE,limit:n.ITEMS_PER_PAGE}});case 6:o=t.sent,this.blockedRegistrations=o,this.totalPages=(null==(r=o.payload.links)?void 0:r.totalPages)||1,t.next=15;break;case 11:t.prev=11,t.t0=t.catch(3),console.error(t.t0),this.blockedRegistrations=[];case 15:this.blockedLoading=!1,this.currentPage=a,m.redraw();case 18:case"end":return t.stop()}}),t,this,[[3,11]])})),function(){var e=this,n=arguments;return new Promise((function(a,o){var s=t.apply(e,n);function i(t){r(s,a,o,i,l,"next",t)}function l(t){r(s,a,o,i,l,"throw",t)}i(void 0)}))});return function(t){return a.apply(this,arguments)}}(),a.renderPagination=function(){var t=this;return m("nav",{className:"BlockedRegistrations--pagination"},m(f(),{className:"Button",disabled:this.currentPage<=1,onclick:function(){return t.loadData(t.currentPage-1)}},"Previous"),m("span",null,"Page ",this.currentPage," of ",this.totalPages),m(f(),{className:"Button",disabled:this.currentPage>=this.totalPages,onclick:function(){return t.loadData(t.currentPage+1)}},"Next"))},a.detailItems=function(t){var n,a=new(y());return a.add("attemptedAt",m("div",{className:"BlockedRegistrations-item--details"},m("span",{className:"BlockedRegistrations-label"},e().translator.trans("fof-anti-spam.admin.blocked_registrations.attempted-at")),m("span",{className:"BlockedRegistrations-value"},k()(null!=(n=t.attemptedAt())?n:new Date))),100),a.add("ip",m("div",{className:"BlockedRegistrations-item--details"},m("span",{className:"BlockedRegistrations-label"},e().translator.trans("fof-anti-spam.admin.blocked_registrations.ip")),m("span",{className:"BlockedRegistrations-value"},t.ip())),90),a.add("email",m("div",{className:"BlockedRegistrations-item--details"},m("span",{className:"BlockedRegistrations-label"},e().translator.trans("fof-anti-spam.admin.blocked_registrations.email")),m("span",{className:"BlockedRegistrations-value"},t.email())),80),a.add("username",m("div",{className:"BlockedRegistrations-item--details"},m("span",{className:"BlockedRegistrations-label"},e().translator.trans("fof-anti-spam.admin.blocked_registrations.username")),m("span",{className:"BlockedRegistrations-value"},t.username())),70),t.provider()&&a.add("provider",m("div",{className:"BlockedRegistrations-item--details"},m("span",{className:"BlockedRegistrations-label"},e().translator.trans("fof-anti-spam.admin.blocked_registrations.login-provider")),m("span",{className:"BlockedRegistrations-value"},m("code",null,t.provider()))),60),t.providerData()&&a.add("providerData",m("div",{className:"BlockedRegistrations-item--details"},m("span",{className:"BlockedRegistrations-label"},e().translator.trans("fof-anti-spam.admin.blocked_registrations.login-provider-data")),m("span",{className:"BlockedRegistrations-value"},m("code",null,t.providerData()))),50),a.add("sfsData",m("div",{className:"BlockedRegistrations-item--details"},m("span",{className:"BlockedRegistrations-label"},e().translator.trans("fof-anti-spam.admin.blocked_registrations.sfs-data")),m("span",{className:"BlockedRegistrations-value"},m("code",null,t.sfsData()))),20),a},a.actionItems=function(t){var n=this,a=new(y());return a.add("delete",m(f(),{className:"Button Button--danger",icon:"fas fa-trash",onclick:function(){var e;t.delete(),n.blockedRegistrations=null==(e=n.blockedRegistrations)?void 0:e.filter((function(e){return e.id()!==t.id()})),m.redraw()}},e().translator.trans("fof-anti-spam.admin.blocked_registrations.delete_entry"))),a},n}(u());w.ITEMS_PER_PAGE=20;const x=flarum.core.compat["common/extenders"];var N=n.n(x);const R=flarum.core.compat["common/Model"];var P=n.n(R),S=function(t){function e(){return t.apply(this,arguments)||this}s(e,t);var n=e.prototype;return n.ip=function(){return P().attribute("ip").call(this)},n.email=function(){return P().attribute("email").call(this)},n.username=function(){return P().attribute("username").call(this)},n.sfsData=function(){return P().attribute("sfsData").call(this)},n.provider=function(){return P().attribute("provider").call(this)},n.providerData=function(){return P().attribute("providerData").call(this)},n.attemptedAt=function(){return P().attribute("attemptedAt",P().transformDate).call(this)},e}(P());const B=[(new(N().Store)).add("blocked-registrations",S)],L=[].concat(B);e().initializers.add("fof/anti-spam",(function(){e().extensionData.for("fof-anti-spam").registerPage(w).registerPermission({icon:"fas fa-pastafarianism",label:e().translator.trans("fof-anti-spam.admin.permissions.spamblock_users_label"),permission:"user.spamblock"},"moderate")}))})(),module.exports=a})();
//# sourceMappingURL=admin.js.map